<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Multiple Sheets | Laravel Simplesheet</title>
    <meta name="description" content="Easy spreadsheet exports and imports in Laravel">
    <link href="https://fonts.googleapis.com/css?family=Nunito:100,300,400,500,600,700" rel="stylesheet" type="text/css">
    
    <link rel="preload" href="/laravel-simplesheet/assets/css/0.styles.4ff61ee7.css" as="style"><link rel="preload" href="/laravel-simplesheet/assets/js/app.7ec92da8.js" as="script"><link rel="preload" href="/laravel-simplesheet/assets/js/2.1850a6cb.js" as="script"><link rel="preload" href="/laravel-simplesheet/assets/js/38.52137e73.js" as="script"><link rel="preload" href="/laravel-simplesheet/assets/js/3.4d23fbea.js" as="script"><link rel="prefetch" href="/laravel-simplesheet/assets/js/10.8217e0b0.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/11.fcf7a36e.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/12.75148aa4.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/13.14e73595.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/14.8619e606.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/15.238d7867.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/16.47e6ded9.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/17.3f57a59c.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/18.b7d12b0a.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/19.73baa82b.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/20.f186e5eb.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/21.03cd8661.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/22.036b937c.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/23.205cd2d8.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/24.6f1572b7.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/25.c8a7e8ad.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/26.2111e70f.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/27.9b20929f.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/28.622b56ad.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/29.1e9e4186.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/30.fc80578b.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/31.83f802b2.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/32.54508042.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/33.7f21ec6e.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/34.18a7a720.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/35.f592dc32.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/36.125d484d.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/37.67fc5517.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/39.fc855bdc.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/4.a5583805.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/40.6a93cca0.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/41.b480f1c5.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/42.afa563dc.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/43.893483aa.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/5.8a1065a6.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/6.4f2ee912.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/7.db2faa10.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/8.e531f9a5.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/9.d00c7991.js">
    <link rel="stylesheet" href="/laravel-simplesheet/assets/css/0.styles.4ff61ee7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/laravel-simplesheet/" class="home-link router-link-active"><!----> <span class="site-name">Laravel Simplesheet</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Version</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/laravel-simplesheet/1.0/" class="nav-link router-link-active">1.0</a></li></ul></div></div> <a href="https://github.com/nikazooz/laravel-simplesheet" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Version</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/laravel-simplesheet/1.0/" class="nav-link router-link-active">1.0</a></li></ul></div></div> <a href="https://github.com/nikazooz/laravel-simplesheet" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Getting Started</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Architecture Concepts</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Exports</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Imports</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/laravel-simplesheet/1.0/imports/" class="sidebar-link">🚀 5 minutes quick start</a></li><li><a href="/laravel-simplesheet/1.0/imports/basics.html" class="sidebar-link">Importing basics</a></li><li><a href="/laravel-simplesheet/1.0/imports/collection.html" class="sidebar-link">Importing to collections</a></li><li><a href="/laravel-simplesheet/1.0/imports/model.html" class="sidebar-link">Importing to models</a></li><li><a href="/laravel-simplesheet/1.0/imports/importables.html" class="sidebar-link">Importables</a></li><li><a href="/laravel-simplesheet/1.0/imports/import-formats.html" class="sidebar-link">Import formats</a></li><li><a href="/laravel-simplesheet/1.0/imports/multiple-sheets.html" class="active sidebar-link">Multiple Sheets</a></li><li><a href="/laravel-simplesheet/1.0/imports/heading-row.html" class="sidebar-link">Heading row</a></li><li><a href="/laravel-simplesheet/1.0/imports/batch-inserts.html" class="sidebar-link">Batch inserts</a></li><li><a href="/laravel-simplesheet/1.0/imports/queued.html" class="sidebar-link">Queued reading</a></li><li><a href="/laravel-simplesheet/1.0/imports/validation.html" class="sidebar-link">Row Validation</a></li><li><a href="/laravel-simplesheet/1.0/imports/custom-csv-settings.html" class="sidebar-link">Custom CSV Settings</a></li><li><a href="/laravel-simplesheet/1.0/imports/concerns.html" class="sidebar-link">Import concerns</a></li><li><a href="/laravel-simplesheet/1.0/imports/extending.html" class="sidebar-link">Extending</a></li><li><a href="/laravel-simplesheet/1.0/imports/testing.html" class="sidebar-link">Testing</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="content default"><h1 id="multiple-sheets"><a href="#multiple-sheets" aria-hidden="true" class="header-anchor">#</a> Multiple Sheets</h1> <p></p><div class="table-of-contents"><ul><li><a href="#selecting-sheets-by-worksheet-index">Selecting sheets by worksheet index</a></li><li><a href="#selecting-sheets-by-worksheet-name">Selecting sheets by worksheet name</a></li><li><a href="#skipping-unknown-sheets">Skipping unknown sheets</a><ul><li><a href="#skipping-only-specific-sheets">Skipping only specific sheets</a></li></ul></li><li><a href="#conditional-sheet-loading">Conditional sheet loading</a></li></ul></div><p></p> <p>When a file has multiple sheets, each sheet will go through the import object. If you want to handle each sheet separately, you'll need to implement the <code>WithMultipleSheets</code> concern.</p> <p>The <code>sheets()</code> method expects an array of sheet import objects to be returned. The order of the sheets is important, the first sheet import object in the array will automatically be linked to the first worksheet in the excel file.</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Imports</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Nikazooz<span class="token punctuation">\</span>Simplesheet<span class="token punctuation">\</span>Concerns<span class="token punctuation">\</span>WithMultipleSheets</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">UsersImport</span> <span class="token keyword">implements</span> <span class="token class-name">WithMultipleSheets</span>
<span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">sheets</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">array</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span>
            <span class="token keyword">new</span> <span class="token class-name">FirstSheetImport</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>A sheet import class can import the same concerns as a normal import object.</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Imports</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>Collection</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Nikazooz<span class="token punctuation">\</span>Simplesheet<span class="token punctuation">\</span>Concerns<span class="token punctuation">\</span>ToCollection</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">FirstSheetImport</span> <span class="token keyword">implements</span> <span class="token class-name">ToCollection</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">collection</span><span class="token punctuation">(</span>Collection <span class="token variable">$rows</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">//</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="selecting-sheets-by-worksheet-index"><a href="#selecting-sheets-by-worksheet-index" aria-hidden="true" class="header-anchor">#</a> Selecting sheets by worksheet index</h2> <p>If you want more control over which sheets are selected and how they are mapped to specific sheet import objects, you can use the sheet index as key. Sheet indices start at 0.</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Imports</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Nikazooz<span class="token punctuation">\</span>Simplesheet<span class="token punctuation">\</span>Concerns<span class="token punctuation">\</span>WithMultipleSheets</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">UsersImport</span> <span class="token keyword">implements</span> <span class="token class-name">WithMultipleSheets</span>
<span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">sheets</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">array</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span>
            <span class="token number">0</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token keyword">new</span> <span class="token class-name">FirstSheetImport</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token number">1</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token keyword">new</span> <span class="token class-name">SecondSheetImport</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="selecting-sheets-by-worksheet-name"><a href="#selecting-sheets-by-worksheet-name" aria-hidden="true" class="header-anchor">#</a> Selecting sheets by worksheet name</h2> <p>If you only know the name of the worksheet and don't know the sheet index, you can also use the worksheet name as a selector. Put the worksheet name as array index to link that worksheet to your sheet import object.</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Imports</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Nikazooz<span class="token punctuation">\</span>Simplesheet<span class="token punctuation">\</span>Concerns<span class="token punctuation">\</span>WithMultipleSheets</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">UsersImport</span> <span class="token keyword">implements</span> <span class="token class-name">WithMultipleSheets</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">sheets</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">array</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span>
            <span class="token single-quoted-string string">'Worksheet 1'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token keyword">new</span> <span class="token class-name">FirstSheetImport</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'Worksheet 2'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token keyword">new</span> <span class="token class-name">SecondSheetImport</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><div class="warning custom-block"><p class="custom-block-title">WARNING</p> <p>Sheets that are not explicitly defined in the <code>sheet()</code> method, will be ignored and thus not be imported.</p></div> <h2 id="skipping-unknown-sheets"><a href="#skipping-unknown-sheets" aria-hidden="true" class="header-anchor">#</a> Skipping unknown sheets</h2> <p>When you have defined a sheet <strong>name</strong> or <strong>index</strong> that does not exist a <code>Nikazooz\Simplesheet\Exceptions\SheetNotFoundException</code> will be thrown.</p> <p>If you want to ignore when a sheet does not exists, you can use the <code>Nikazooz\Simplesheet\Concerns\SkipsUnknownSheets</code> concern.</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Imports</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Nikazooz<span class="token punctuation">\</span>Simplesheet<span class="token punctuation">\</span>Concerns<span class="token punctuation">\</span>WithMultipleSheets</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Nikazooz<span class="token punctuation">\</span>Simplesheet<span class="token punctuation">\</span>Concerns<span class="token punctuation">\</span>SkipsUnknownSheets</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">UsersImport</span> <span class="token keyword">implements</span> <span class="token class-name">WithMultipleSheets</span><span class="token punctuation">,</span> SkipsUnknownSheets
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">sheets</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">array</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span>
            <span class="token single-quoted-string string">'Worksheet 1'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token keyword">new</span> <span class="token class-name">FirstSheetImport</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'Worksheet 2'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token keyword">new</span> <span class="token class-name">SecondSheetImport</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">onUnknownSheet</span><span class="token punctuation">(</span><span class="token variable">$sheetName</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// E.g. you can log that a sheet was not found.</span>
        <span class="token function">info</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;Sheet <span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$sheetName</span><span class="token punctuation">}</span></span> was skipped&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="skipping-only-specific-sheets"><a href="#skipping-only-specific-sheets" aria-hidden="true" class="header-anchor">#</a> Skipping only specific sheets</h3> <p>If you want to have 1 optional sheet and still have the others fail, you can also let the Sheet import object implement <code>SkipsUnknownSheets</code>.</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Imports</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Nikazooz<span class="token punctuation">\</span>Simplesheet<span class="token punctuation">\</span>Concerns<span class="token punctuation">\</span>SkipsUnknownSheets</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">FirstSheetImport</span> <span class="token keyword">implements</span> <span class="token class-name">SkipsUnknownSheets</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">onUnknownSheet</span><span class="token punctuation">(</span><span class="token variable">$sheetName</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// E.g. you can log that a sheet was not found.</span>
        <span class="token function">info</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;Sheet <span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$sheetName</span><span class="token punctuation">}</span></span> was skipped&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>Now only <code>FirstSheetImport</code> will be skipped if it's not found. Any other defined sheet will be skipped.</p> <h2 id="conditional-sheet-loading"><a href="#conditional-sheet-loading" aria-hidden="true" class="header-anchor">#</a> Conditional sheet loading</h2> <p>If you want to indicate per import which sheets should be imported, you can use the <code>Nikazooz\Simplesheet\Concerns\WithConditionalSheets</code> trait.</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Imports</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Nikazooz<span class="token punctuation">\</span>Simplesheet<span class="token punctuation">\</span>Concerns<span class="token punctuation">\</span>WithMultipleSheets</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Nikazooz<span class="token punctuation">\</span>Simplesheet<span class="token punctuation">\</span>Concerns<span class="token punctuation">\</span>WithConditionalSheets</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">UsersImport</span> <span class="token keyword">implements</span> <span class="token class-name">WithMultipleSheets</span>
<span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token package">WithConditionalSheets</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">conditionalSheets</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">array</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span>
            <span class="token single-quoted-string string">'Worksheet 1'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token keyword">new</span> <span class="token class-name">FirstSheetImport</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'Worksheet 2'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token keyword">new</span> <span class="token class-name">SecondSheetImport</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'Worksheet 3'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token keyword">new</span> <span class="token class-name">ThirdSheetImport</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>Now you can use the <code>onlySheets</code> method to indicate which sheets should be loaded for this import.</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token variable">$import</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UsersImport</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$import</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">onlySheets</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Worksheet 1'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'Worksheet 3'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Simplesheet<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">import</span><span class="token punctuation">(</span><span class="token variable">$import</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'users.xlsx'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/nikazooz/laravel-simplesheet-docs/edit/master/1.0/imports/multiple-sheets.md" target="_blank" rel="noopener noreferrer">Help us improve this page!</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/laravel-simplesheet/1.0/imports/import-formats.html" class="prev">
          Import formats
        </a></span> <span class="next"><a href="/laravel-simplesheet/1.0/imports/heading-row.html">
          Heading row
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/laravel-simplesheet/assets/js/app.7ec92da8.js" defer></script><script src="/laravel-simplesheet/assets/js/2.1850a6cb.js" defer></script><script src="/laravel-simplesheet/assets/js/38.52137e73.js" defer></script><script src="/laravel-simplesheet/assets/js/3.4d23fbea.js" defer></script>
  </body>
</html>
