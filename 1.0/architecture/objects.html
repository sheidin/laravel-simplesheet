<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Import &amp; Export Objects | Laravel Simplesheet</title>
    <meta name="description" content="Easy spreadsheet exports and imports in Laravel">
    <link href="https://fonts.googleapis.com/css?family=Nunito:100,300,400,500,600,700" rel="stylesheet" type="text/css">
    
    <link rel="preload" href="/laravel-simplesheet/assets/css/0.styles.4ff61ee7.css" as="style"><link rel="preload" href="/laravel-simplesheet/assets/js/app.7ec92da8.js" as="script"><link rel="preload" href="/laravel-simplesheet/assets/js/2.1850a6cb.js" as="script"><link rel="preload" href="/laravel-simplesheet/assets/js/9.d00c7991.js" as="script"><link rel="preload" href="/laravel-simplesheet/assets/js/3.4d23fbea.js" as="script"><link rel="prefetch" href="/laravel-simplesheet/assets/js/10.8217e0b0.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/11.fcf7a36e.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/12.75148aa4.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/13.14e73595.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/14.8619e606.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/15.238d7867.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/16.47e6ded9.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/17.3f57a59c.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/18.b7d12b0a.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/19.73baa82b.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/20.f186e5eb.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/21.03cd8661.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/22.036b937c.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/23.205cd2d8.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/24.6f1572b7.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/25.c8a7e8ad.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/26.2111e70f.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/27.9b20929f.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/28.622b56ad.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/29.1e9e4186.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/30.fc80578b.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/31.83f802b2.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/32.54508042.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/33.7f21ec6e.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/34.18a7a720.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/35.f592dc32.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/36.125d484d.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/37.67fc5517.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/38.52137e73.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/39.fc855bdc.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/4.a5583805.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/40.6a93cca0.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/41.b480f1c5.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/42.afa563dc.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/43.893483aa.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/5.8a1065a6.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/6.4f2ee912.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/7.db2faa10.js"><link rel="prefetch" href="/laravel-simplesheet/assets/js/8.e531f9a5.js">
    <link rel="stylesheet" href="/laravel-simplesheet/assets/css/0.styles.4ff61ee7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/laravel-simplesheet/" class="home-link router-link-active"><!----> <span class="site-name">Laravel Simplesheet</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Version</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/laravel-simplesheet/1.0/" class="nav-link router-link-active">1.0</a></li></ul></div></div> <a href="https://github.com/nikazooz/laravel-simplesheet" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Version</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/laravel-simplesheet/1.0/" class="nav-link router-link-active">1.0</a></li></ul></div></div> <a href="https://github.com/nikazooz/laravel-simplesheet" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Getting Started</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Architecture Concepts</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/laravel-simplesheet/1.0/architecture/" class="sidebar-link">Lifecycle</a></li><li><a href="/laravel-simplesheet/1.0/architecture/objects.html" class="active sidebar-link">Import &amp; Export Objects</a></li><li><a href="/laravel-simplesheet/1.0/architecture/concerns.html" class="sidebar-link">Concerns</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Exports</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Imports</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="content default"><h1 id="import-export-objects"><a href="#import-export-objects" aria-hidden="true" class="header-anchor">#</a> Import &amp; Export Objects</h1> <p></p><div class="table-of-contents"><ul><li><a href="#directory-structure">Directory structure</a></li><li><a href="#encapsulation">Encapsulation</a></li><li><a href="#data-transfer-object">Data transfer object</a></li><li><a href="#plain-old-php-object">Plain Old PHP Object</a><ul><li><a href="#constructor">Constructor</a></li><li><a href="#setters">Setters</a></li><li><a href="#getters">Getters</a></li></ul></li><li><a href="#concerns">Concerns</a></li><li><a href="#hooks">Hooks</a></li></ul></div><p></p> <p>The entire Laravel Simplesheet philosophy evolves around having <code>Export</code> and/or <code>Import</code> objects.</p> <h2 id="directory-structure"><a href="#directory-structure" aria-hidden="true" class="header-anchor">#</a> Directory structure</h2> <p>The location of these Import and Exports classes could be as follows:</p> <pre class="vue-container"><code><p>.
├── app
│   ├── <code>Exports</code> <em>(<strong>Groups all exports in your app</strong>)</em>
│   │   ├── UsersExport.php
│   │   ├── ProductsExport.php
│   │   └── <code>Sheets</code> <em>(<strong>You can group sheets together</strong>)</em>
│   │      ├── InactiveUsersSheet.php
│   │      └── ActiveUsersSheet.php
|   |
│   ├── <code>Imports</code> <em>(<strong>Groups all imports in your app</strong>)</em>
│   │   ├── UsersImport.php
│   │   ├── ProductsImport.php
│   │   └── <code>Sheets</code> <em>(<strong>You can group sheets together</strong>)</em>
│   │      ├── OutOfStockProductsSheet.php
│   │      └── ProductsOnSaleSheet.php
│ 
└── composer.json</p>
</code></pre><h2 id="encapsulation"><a href="#encapsulation" aria-hidden="true" class="header-anchor">#</a> Encapsulation</h2> <p>These objects encapsulate the entire export or import process.
The idea behind it is that you can neatly use these objects in controllers, services, jobs, event listeners or commands.
In all of theses cases, the entire logic of how the export/import needs to happen is kept within this object.</p> <h2 id="data-transfer-object"><a href="#data-transfer-object" aria-hidden="true" class="header-anchor">#</a> Data transfer object</h2> <p>The import/export objects are in essence simple data transfer objects (DTO).
This means they will transfer the information you want to export/import to the Simplesheet writer/reader.
This information is not only the actual data you want to export, but also additional information like
the styling of the file, the name of the worksheet, the number format of the cell etc.</p> <p>In most cases, this means that your code doesn't need to have direct exposure to the actual read/write process.</p> <h2 id="plain-old-php-object"><a href="#plain-old-php-object" aria-hidden="true" class="header-anchor">#</a> Plain Old PHP Object</h2> <p>Besides being a DTO, the import/export objects are also just Plain Old PHP Objects (POPO). This means that you can do anything with them that you can do with normal PHP objects.</p> <h3 id="constructor"><a href="#constructor" aria-hidden="true" class="header-anchor">#</a> Constructor</h3> <p>For instance, you can simply inject data through the constructor of the export object.</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">class</span> <span class="token class-name">UsersExport</span> <span class="token keyword">implements</span> <span class="token class-name">FromCollection</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token variable">$year</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span>int <span class="token variable">$year</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">year</span> <span class="token operator">=</span> <span class="token variable">$year</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">collection</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> Users<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">whereYear</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'created_at'</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">year</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><div class="language-php line-numbers-mode"><pre class="language-php"><code>Simplesheet<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">download</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">UsersExport</span><span class="token punctuation">(</span><span class="token number">2019</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'users.xlsx'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="setters"><a href="#setters" aria-hidden="true" class="header-anchor">#</a> Setters</h3> <p>Another option is to add setters for data that you want to pass.</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">class</span> <span class="token class-name">UsersExport</span> <span class="token keyword">implements</span> <span class="token class-name">FromCollection</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token variable">$year</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">setYear</span><span class="token punctuation">(</span>int <span class="token variable">$year</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">year</span> <span class="token operator">=</span> <span class="token variable">$year</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">collection</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> Users<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">whereYear</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'created_at'</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">year</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token variable">$export</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UsersExport</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$export</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">setYear</span><span class="token punctuation">(</span><span class="token number">2019</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Simplesheet<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">download</span><span class="token punctuation">(</span><span class="token variable">$export</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'users.xlsx'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="getters"><a href="#getters" aria-hidden="true" class="header-anchor">#</a> Getters</h3> <p>In similar fashion to setters, you can also add getters. This can potentially be useful if you want to keep a state of your export/import.</p> <p>For instance, you can keep a row count in your users import.</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Imports</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>User</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Nikazooz<span class="token punctuation">\</span>Simplesheet<span class="token punctuation">\</span>Concerns<span class="token punctuation">\</span>ToModel</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">UsersImport</span> <span class="token keyword">implements</span> <span class="token class-name">ToModel</span>
<span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token variable">$rows</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">model</span><span class="token punctuation">(</span><span class="token keyword">array</span> <span class="token variable">$row</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token operator">++</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">rows</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
            <span class="token single-quoted-string string">'name'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">getRowCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> int
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">rows</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>After doing the import, we can request the state with the getter.</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token variable">$import</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UsersImport</span><span class="token punctuation">;</span>
Simplesheet<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">import</span><span class="token punctuation">(</span><span class="token variable">$import</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'users.xlsx'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">dd</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Row count: '</span> <span class="token punctuation">.</span> <span class="token variable">$import</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">getRowCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="concerns"><a href="#concerns" aria-hidden="true" class="header-anchor">#</a> Concerns</h2> <p>Most of the export/import configuration is done by using <strong>Concerns</strong>. Concerns are basically just simple interfaces.
Implementing them will make the object adhere to a certain contract. This contract can request specific methods that e.g. data can be passed through.
In other cases it might not ask for any methods to be implemented, but merely functions as a pointer interface.</p> <p>Read more about Concerns in the <a href="/laravel-simplesheet/3.1/architecture/concerns.html">concerns documentation</a>.</p> <h2 id="hooks"><a href="#hooks" aria-hidden="true" class="header-anchor">#</a> Hooks</h2> <p>In more complex cases you might want to hook into certain moments of the read/write process. This can be done by using Events.
To register these events in your import/export object, you need to implement the <code>Nikazooz\Simplesheet\Concerns\WithEvents</code> concern.</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Exports</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Nikazooz<span class="token punctuation">\</span>Simplesheet<span class="token punctuation">\</span>Concerns<span class="token punctuation">\</span>WithEvents</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Nikazooz<span class="token punctuation">\</span>Simplesheet<span class="token punctuation">\</span>Events<span class="token punctuation">\</span>BeforeExport</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">UsersExport</span> <span class="token keyword">implements</span> <span class="token class-name">WithEvents</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * @return array
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">registerEvents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">array</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span>
            <span class="token comment">// Handle by a closure.</span>
            BeforeExport<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token keyword">function</span><span class="token punctuation">(</span>BeforeExport <span class="token variable">$event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// Do something before the export process starts.</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/nikazooz/laravel-simplesheet-docs/edit/master/1.0/architecture/objects.md" target="_blank" rel="noopener noreferrer">Help us improve this page!</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/laravel-simplesheet/1.0/architecture/" class="prev router-link-active">
          Lifecycle
        </a></span> <span class="next"><a href="/laravel-simplesheet/1.0/architecture/concerns.html">
          Concerns
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/laravel-simplesheet/assets/js/app.7ec92da8.js" defer></script><script src="/laravel-simplesheet/assets/js/2.1850a6cb.js" defer></script><script src="/laravel-simplesheet/assets/js/9.d00c7991.js" defer></script><script src="/laravel-simplesheet/assets/js/3.4d23fbea.js" defer></script>
  </body>
</html>
